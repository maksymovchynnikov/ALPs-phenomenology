(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     65487,       1642]
NotebookOptionsPosition[     62956,       1590]
NotebookOutlinePosition[     63389,       1607]
CellTagsIndexPosition[     63346,       1604]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Total ALP-meson Lagrangian used to compute the widths", "Chapter",
 CellChangeTimes->{{3.905482245111978*^9, 3.905482252267702*^9}, 
   3.9054845465957365`*^9},ExpressionUUID->"ff54bf5a-3a9c-4a78-8504-\
076d2e42f341"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"genlagropt", "=", 
   RowBox[{"dropdownDialog", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<Generate\>\"", ",", "\"\<Import\>\""}], "}"}], ",", 
     "\"\<Generate the total ALP-meson interaction Lagrangian from scratch, \
or just import it (if it has been generated previously)?\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fLagr", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}], 
      ",", "\"\<Temporary data/Lagr.m\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"genlagropt", "==", "\"\<Import\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"FileExistsQ", "[", "fLagr", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TotalLagrangianScaled", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"fLagr", ",", "\"\<MX\>\""}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<The Lagrangian file does not exist. Must be generated...\>\"", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"genlagropt", "=", "\"\<Generate\>\""}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9446413202367687`*^9, 3.9446413559670143`*^9}, {
  3.9446429785534954`*^9, 3.944643071701193*^9}, {3.9446431712132072`*^9, 
  3.944643182052946*^9}, {3.9446432528656673`*^9, 3.944643259904623*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"1656fec3-df5a-ae42-ba30-05fea24b0c8e"],

Cell[CellGroupData[{

Cell["Definitions", "Section",
 CellChangeTimes->{{3.9006507508639374`*^9, 3.9006507624836845`*^9}, 
   3.901073209856551*^9, 
   3.9054822595256643`*^9},ExpressionUUID->"182e74c5-ecc8-4a0e-a485-\
d9a71da3ab97"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"genlagropt", "==", "\"\<Generate\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FieldsListPattern", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PfieldSymbol", "[", 
               RowBox[{"field", ",", "x"}], "]"}], ",", 
              RowBox[{"dPfieldSymbol", "[", 
               RowBox[{"field", ",", "x", ",", "a_"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"field", ",", "listMesonP"}], "}"}]}], "]"}], "//", 
          "Flatten"}], ",", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SfieldSymbol", "[", 
               RowBox[{"field", ",", "x"}], "]"}], ",", 
              RowBox[{"dSfieldSymbol", "[", 
               RowBox[{"field", ",", "x", ",", "a_"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"field", ",", "listMesonS"}], "}"}]}], "]"}], "//", 
          "Flatten"}], ",", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"VfieldSymbol", "[", 
               RowBox[{"field", ",", "x", ",", "a_"}], "]"}], ",", 
              RowBox[{"dVfieldSymbol", "[", 
               RowBox[{"field", ",", "x", ",", "a_", ",", "b_"}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"field", ",", "listMesonV"}], "}"}]}], "]"}], "//", 
          "Flatten"}], ",", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"VAfieldSymbol", "[", 
               RowBox[{"field", ",", "x", ",", "a_"}], "]"}], ",", 
              RowBox[{"dVAfieldSymbol", "[", 
               RowBox[{"field", ",", "x", ",", "a_", ",", "b_"}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"field", ",", "listMesonVA"}], "}"}]}], "]"}], "//", 
          "Flatten"}], ",", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"TfieldSymbol", "[", 
               RowBox[{"field", ",", "x", ",", "a_", ",", "b_"}], "]"}], ",", 
              RowBox[{"dTfieldSymbol", "[", 
               RowBox[{"field", ",", "x", ",", "a_", ",", "b_", ",", "c_"}], 
               "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"field", ",", "listMesonT"}], "}"}]}], "]"}], "//", 
          "Flatten"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"FieldsList", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PfieldSymbol", "[", 
               RowBox[{"field", ",", "x"}], "]"}], ",", 
              RowBox[{"dPfieldSymbol", "[", 
               RowBox[{"field", ",", "x", ",", "a"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"field", ",", "listMesonP"}], "}"}]}], "]"}], "//", 
          "Flatten"}], ",", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SfieldSymbol", "[", 
               RowBox[{"field", ",", "x"}], "]"}], ",", 
              RowBox[{"dSfieldSymbol", "[", 
               RowBox[{"field", ",", "x", ",", "a"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"field", ",", "listMesonS"}], "}"}]}], "]"}], "//", 
          "Flatten"}], ",", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"VfieldSymbol", "[", 
               RowBox[{"field", ",", "x", ",", "a"}], "]"}], ",", 
              RowBox[{"dVfieldSymbol", "[", 
               RowBox[{"field", ",", "x", ",", "a", ",", "b"}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"field", ",", "listMesonV"}], "}"}]}], "]"}], "//", 
          "Flatten"}], ",", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"TfieldSymbol", "[", 
               RowBox[{"field", ",", "x", ",", "a", ",", "b"}], "]"}], ",", 
              RowBox[{"dTfieldSymbol", "[", 
               RowBox[{"field", ",", "x", ",", "a", ",", "b", ",", "c"}], 
               "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"field", ",", "listMesonT"}], "}"}]}], "]"}], "//", 
          "Flatten"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Scale", " ", "coefficients", " ", "counting", " ", "the", " ", 
        "number", " ", "of", " ", "times", " ", "the", " ", "given", " ", 
        "field", " ", "or", " ", "its", " ", "derivative", " ", "enters", " ",
         "the", " ", "given", " ", "term"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CoefficientsListIndividual", "=", 
       RowBox[{"t", "^", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"y", "[", "field", "]"}], ",", 
               RowBox[{"y", "[", "field", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"field", ",", "listMesonP"}], "}"}]}], "]"}], "//", 
           "Flatten"}], ",", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"y", "[", "field", "]"}], ",", 
               RowBox[{"y", "[", "field", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"field", ",", "listMesonS"}], "}"}]}], "]"}], "//", 
           "Flatten"}], ",", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"y", "[", "field", "]"}], ",", 
               RowBox[{"y", "[", "field", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"field", ",", "listMesonV"}], "}"}]}], "]"}], "//", 
           "Flatten"}], ",", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"y", "[", "field", "]"}], ",", 
               RowBox[{"y", "[", "field", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"field", ",", "listMesonT"}], "}"}]}], "]"}], "//", 
           "Flatten"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Scale", " ", "coefficients", " ", "that", " ", "count", " ", "how", 
        " ", "many", " ", "fields", " ", "or", " ", "their", " ", 
        "derivatives", " ", "the", " ", "given", " ", "term", " ", "contains",
         " ", "in", " ", "total"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CoefficientsListCommon", "=", 
       RowBox[{"t", "^", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"y", "[", "field", "]"}], ",", 
               RowBox[{"y", "[", "field", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"field", ",", "listMesonP"}], "}"}]}], "]"}], "//", 
           "Flatten"}], ",", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"y", "[", "field", "]"}], ",", 
               RowBox[{"y", "[", "field", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"field", ",", "listMesonS"}], "}"}]}], "]"}], "//", 
           "Flatten"}], ",", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"y", "[", "field", "]"}], ",", 
               RowBox[{"y", "[", "field", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"field", ",", "listMesonV"}], "}"}]}], "]"}], "//", 
           "Flatten"}], ",", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"y", "[", "field", "]"}], ",", 
               RowBox[{"y", "[", "field", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"field", ",", "listMesonT"}], "}"}]}], "]"}], "//", 
           "Flatten"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CoefficientsListALP", "=", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["ta", "y"], ",", 
         SuperscriptBox["ta", "y"]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Replacement", " ", "rule", " ", "field"}], "->", "scaling"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"repsIndividual", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"FieldsListPattern", "->", 
         RowBox[{"CoefficientsListIndividual", "*", "FieldsList"}]}], "]"}]}],
       ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"repsCommon", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{"FieldsListPattern", "->", 
        RowBox[{"CoefficientsListCommon", "*", "FieldsList"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"repsALP", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"alp", "[", "x", "]"}], ",", 
          RowBox[{"dalp", "[", 
           RowBox[{"x", ",", "a_"}], "]"}]}], "}"}], "->", 
        RowBox[{"CoefficientsListALP", "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"alp", "[", "x", "]"}], ",", 
           RowBox[{"dalp", "[", 
            RowBox[{"x", ",", "a"}], "]"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Scaling", " ", "rules", " ", "to", " ", "convert", " ", "the", " ", 
       "Lagrangian", " ", "and", " ", "perform", " ", "various", " ", 
       "expansions", " ", "in", " ", "a", " ", "very", " ", "efficient", " ", 
       "manner"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ruleScaling", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PfieldSymbol", "[", 
          RowBox[{"field", ",", "x"}], "]"}], "->", 
         RowBox[{
          RowBox[{"Exp", "[", "y", "]"}], 
          RowBox[{"PfieldSymbol", "[", 
           RowBox[{"field", ",", "x"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"field", ",", "listMesonP"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ruleScaling", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"ruleScaling", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"field", "=", "field"}], ",", 
              RowBox[{"fieldSymb", "=", 
               RowBox[{"fieldSymbol", "[", "field", "]"}]}], ",", 
              RowBox[{"fieldDSymb", "=", 
               RowBox[{"dfieldSymbol", "[", "field", "]"}]}]}], "}"}], ",", 
            RowBox[{
             RowBox[{"fieldDSymb", "[", 
              RowBox[{"x", ",", "a_"}], "]"}], ":>", 
             RowBox[{
              RowBox[{"Exp", "[", "y", "]"}], 
              RowBox[{"fieldDSymb", "[", 
               RowBox[{"x", ",", "a"}], "]"}]}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"field", ",", "listMesonP"}], "}"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ruleScaling", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"ruleScaling", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SfieldSymbol", "[", 
            RowBox[{"field", ",", "x"}], "]"}], "->", 
           RowBox[{
            RowBox[{"Exp", "[", "y", "]"}], 
            RowBox[{"SfieldSymbol", "[", 
             RowBox[{"field", ",", "x"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"field", ",", "listMesonS"}], "}"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ruleScaling", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"ruleScaling", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"field", "=", "field"}], ",", 
              RowBox[{"fieldSymb", "=", 
               RowBox[{"fieldSymbol", "[", "field", "]"}]}], ",", 
              RowBox[{"fieldDSymb", "=", 
               RowBox[{"dfieldSymbol", "[", "field", "]"}]}]}], "}"}], ",", 
            RowBox[{
             RowBox[{"fieldDSymb", "[", 
              RowBox[{"x", ",", "a_"}], "]"}], ":>", 
             RowBox[{
              RowBox[{"Exp", "[", "y", "]"}], 
              RowBox[{"fieldDSymb", "[", 
               RowBox[{"x", ",", "a"}], "]"}]}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"field", ",", "listMesonS"}], "}"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ruleScaling", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"ruleScaling", ",", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"field", "=", "field"}], ",", 
               RowBox[{"fieldSymb", "=", 
                RowBox[{"fieldSymbol", "[", "field", "]"}]}], ",", 
               RowBox[{"fieldDSymb", "=", 
                RowBox[{"dfieldSymbol", "[", "field", "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"fieldSymb", "[", 
                 RowBox[{"x", ",", "a_"}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"Exp", "[", "y", "]"}], 
                 RowBox[{"fieldSymb", "[", 
                  RowBox[{"x", ",", "a"}], "]"}]}]}], ",", 
               RowBox[{
                RowBox[{"fieldDSymb", "[", 
                 RowBox[{"x", ",", "a_", ",", "b_"}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"Exp", "[", "y", "]"}], 
                 RowBox[{"fieldDSymb", "[", 
                  RowBox[{"x", ",", "a", ",", "b"}], "]"}]}]}]}], "}"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"field", ",", "listMesonV"}], "}"}]}], "]"}], "//", 
         "Flatten"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ruleScaling", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"ruleScaling", ",", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"field", "=", "field"}], ",", 
               RowBox[{"fieldSymb", "=", 
                RowBox[{"fieldSymbol", "[", "field", "]"}]}], ",", 
               RowBox[{"fieldDSymb", "=", 
                RowBox[{"dfieldSymbol", "[", "field", "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"fieldSymb", "[", 
                 RowBox[{"x", ",", "a_"}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"Exp", "[", "y", "]"}], 
                 RowBox[{"fieldSymb", "[", 
                  RowBox[{"x", ",", "a"}], "]"}]}]}], ",", 
               RowBox[{
                RowBox[{"fieldDSymb", "[", 
                 RowBox[{"x", ",", "a_", ",", "b_"}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"Exp", "[", "y", "]"}], 
                 RowBox[{"fieldDSymb", "[", 
                  RowBox[{"x", ",", "a", ",", "b"}], "]"}]}]}]}], "}"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"field", ",", "listMesonVA"}], "}"}]}], "]"}], "//", 
         "Flatten"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ruleScaling", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"ruleScaling", ",", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"field", "=", "field"}], ",", 
               RowBox[{"fieldSymb", "=", 
                RowBox[{"fieldSymbol", "[", "field", "]"}]}], ",", 
               RowBox[{"fieldDSymb", "=", 
                RowBox[{"dfieldSymbol", "[", "field", "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"fieldSymb", "[", 
                 RowBox[{"x", ",", "a_", ",", "b_"}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"Exp", "[", "y", "]"}], 
                 RowBox[{"fieldSymb", "[", 
                  RowBox[{"x", ",", "a", ",", "b"}], "]"}]}]}], ",", 
               RowBox[{
                RowBox[{"fieldDSymb", "[", 
                 RowBox[{"x", ",", "a_", ",", "b_", ",", "c_"}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"Exp", "[", "y", "]"}], 
                 RowBox[{"fieldDSymb", "[", 
                  RowBox[{"x", ",", "a", ",", "b", ",", "c"}], "]"}]}]}]}], 
              "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"field", ",", "listMesonT"}], "}"}]}], "]"}], "//", 
         "Flatten"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.944641945117338*^9, 3.944641991559561*^9}, {
  3.9470071892761784`*^9, 3.947007225255701*^9}, {3.9470072570018044`*^9, 
  3.9470072620747604`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"9fd915b9-6d11-4845-abe3-6a118be2417e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lagrangian calculation", "Section",
 CellChangeTimes->{{3.905482269105935*^9, 
  3.905482272395975*^9}},ExpressionUUID->"6227a437-a31b-4664-ac11-\
239f261225df"],

Cell[CellGroupData[{

Cell["Diagonalization", "Subsection",
 CellChangeTimes->{{3.9446413741629066`*^9, 
  3.944641377102228*^9}},ExpressionUUID->"0b738306-4a18-6b41-a7bf-\
641c23077c56"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"genlagropt", "==", "\"\<Generate\>\""}], ",", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Sum", " ", "of", " ", "the", " ", "operators", " ", "describing", " ", 
      "the", " ", "interactions", " ", "of", " ", "mesons", " ", "and", " ", 
      "ALPs"}], " ", "-", " ", 
     RowBox[{
     "before", " ", "the", " ", "diagonalization", " ", "of", " ", "the", " ",
       "mass", " ", "and", " ", "kinetic", " ", "matrices"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TotalLagrangianBeforeDiagonalization", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "ChPTkineticTerm", "+", "ChPTbreakingTerm", "+", "VMDtermALP", "+", 
        "LscalarALP", " ", "+", "LagrangianTalp", "+", "LagrangianVAalp", "+",
         "WeakDecaysTermALP"}], ")"}], "//", "Expand"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"If", " ", "users", " ", "choose", " ", "\[Kappa]"}], "-", 
       RowBox[{"variant", " ", "approach"}]}], ",", " ", 
      RowBox[{
       RowBox[{
       "setting", " ", "the", " ", "pieces", " ", "ensuring", " ", "the", " ",
         "\[Kappa]"}], "-", 
       RowBox[{"independence", " ", "to", " ", "zero"}]}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", "\[Kappa]invariant"}], ",", 
      RowBox[{"TotalLagrangianBeforeDiagonalization", "=", 
       RowBox[{"TotalLagrangianBeforeDiagonalization", "/.", 
        RowBox[{"{", 
         RowBox[{"cG", "->", "0"}], "}"}]}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Performing", " ", "symbolic", " ", "diagonalization"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"expr2", "=", 
     RowBox[{
     "TotalLagrangianBeforeDiagonalization", "/.", 
      "rulem0aTransformationSymbolic"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Leaving", " ", "only", " ", "terms", " ", "up", " ", "to", " ", 
       "linear", " ", "in", " ", "ALP", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"+", " ", "kinetic"}], " ", "Lagrangian"}], ")"}]}], ",", 
      " ", 
      RowBox[{
       RowBox[{"in", " ", "\[Epsilon]"}], " ", "==", " ", 
       RowBox[{
        SubscriptBox["f", "\[Pi]"], "/", 
        SubscriptBox["f", "a"]}]}], ",", " ", 
      RowBox[{"and", " ", "\[Delta]"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"indiceslist", "=", 
     RowBox[{"{", 
      RowBox[{
      "\[Mu]", ",", "\[Nu]", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]",
        ",", "\[Delta]", ",", "\[Rho]", ",", "\[Sigma]", ",", "\[Epsilon]"}], 
      "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"expr3", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"expr2", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"alp", "[", "x", "]"}], "->", "0"}], ",", 
          RowBox[{
           RowBox[{"dalp", "[", 
            RowBox[{"x", ",", "a_"}], "]"}], ":>", "0"}]}], "}"}]}], ")"}], 
      "+", 
      RowBox[{
       RowBox[{"alp", "[", "x", "]"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"expr2", ",", 
           RowBox[{"alp", "[", "x", "]"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"alp", "[", "x", "]"}], "->", "0"}], ",", 
           RowBox[{
            RowBox[{"dalp", "[", 
             RowBox[{"x", ",", "a_"}], "]"}], ":>", "0"}]}], "}"}]}], ")"}]}],
       "+", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dalp", "[", 
          RowBox[{"x", ",", "i"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"expr2", ",", 
             RowBox[{"dalp", "[", 
              RowBox[{"x", ",", "i"}], "]"}]}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"alp", "[", "x", "]"}], "->", "0"}], ",", 
             RowBox[{
              RowBox[{"dalp", "[", 
               RowBox[{"x", ",", "a_"}], "]"}], ":>", "0"}]}], "}"}]}], 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "indiceslist"}], "}"}]}], "]"}], "-", 
      RowBox[{
       FractionBox[
        SuperscriptBox["ma", "2"], "2"], 
       SuperscriptBox[
        RowBox[{"alp", "[", "x", "]"}], "2"]}], "+", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"dalp", "[", 
         RowBox[{"x", ",", "\[Mu]"}], "]"}], "2"], "2"]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"expr4", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"expr3", "/.", 
        RowBox[{"{", 
         RowBox[{"\[Epsilon]", "->", "0"}], "}"}]}], ")"}], "+", 
      RowBox[{"\[Epsilon]", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"expr3", ",", "\[Epsilon]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", "->", "0"}], "}"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"expr5", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"expr4", "/.", 
         RowBox[{"{", 
          RowBox[{"\[Delta]", "->", "0"}], "}"}]}], ")"}], "+", 
       RowBox[{"\[Delta]", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"expr4", ",", "\[Delta]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"\[Delta]", "->", "0"}], "}"}]}], ")"}]}]}], ")"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Checking", " ", "that", " ", "the", " ", "diagonalization", " ", 
       "indeed", " ", "kills", " ", "the", " ", "non"}], "-", 
      RowBox[{
      "diagonal", " ", "terms", " ", "in", " ", "the", " ", "quadratic", " ", 
       "Lagrangian"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"tabCrossCheck", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
       "\"\<P1\>\"", ",", "\"\<P2\>\"", ",", 
        "\"\<\!\(\*SubscriptBox[\(L\), \(P1P2, mass\)]\)\>\"", ",", 
        "\"\<\!\(\*SubscriptBox[\(L\), \(P1P2, kinetic\)]\)\>\""}], "}"}], 
      "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"val1", ",", "val2"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"xxx", "=", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"D", "[", 
            RowBox[{"expr5", ",", 
             RowBox[{"PfieldSymbol", "[", 
              RowBox[{"f1", ",", "x"}], "]"}], ",", 
             RowBox[{"PfieldSymbol", "[", 
              RowBox[{"f2", ",", "x"}], "]"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"xxx", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"xxx", "/.", "ruleFieldsToZero"}], "/.", 
            RowBox[{
            "rulem0aTransformationSymbolicToExplicit", "[", 
             "choiceMixingDescription", "]"}]}], "//", "Expand"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"val1", "=", 
          RowBox[{
           RowBox[{"xxx", "/.", 
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["\[Delta]", "2"], "->", "0"}], "}"}]}], "//", 
           "Simplify"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"xxx", "=", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"D", "[", 
            RowBox[{"expr5", ",", 
             RowBox[{"dPfieldSymbol", "[", 
              RowBox[{"f1", ",", "x", ",", "\[Mu]"}], "]"}], ",", 
             RowBox[{"dPfieldSymbol", "[", 
              RowBox[{"f2", ",", "x", ",", "\[Mu]"}], "]"}]}], "]"}]}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"xxx", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"xxx", "/.", "ruleFieldsToZero"}], "/.", 
            RowBox[{
            "rulem0aTransformationSymbolicToExplicit", "[", 
             "choiceMixingDescription", "]"}]}], "//", "Expand"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"val2", "=", 
          RowBox[{
           RowBox[{"xxx", "/.", 
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["\[Delta]", "2"], "->", "0"}], "}"}]}], "//", 
           "Simplify"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tabCrossCheck", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"tabCrossCheck", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"f1", ",", "f2", ",", "val1", ",", "val2"}], "}"}], 
             "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"f1", ",", "listMesonP0a"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"f2", ",", "listMesonP0a"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Dropping", " ", "non"}], "-", 
      RowBox[{"quadratic", " ", "part", " ", "of", " ", "the", " ", 
       RowBox[{"Lagrangian", ".", " ", "This"}], " ", "step", " ", "a", " ", 
       "priori", " ", "assumes", " ", "that", " ", "the", " ", 
       "diagonalization", " ", "indeed", " ", "kills", " ", "non"}], "-", 
      RowBox[{"diagonal", " ", "ALP"}], "-", 
      RowBox[{
       SuperscriptBox["m", "0"], " ", "terms", " ", "in", " ", "the", " ", 
       "kinetic", " ", "and", " ", "mass", " ", "Lagrangian"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"expr6", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"expr5", "/.", "ruleScaling"}], "//", "Expand"}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"2", "*", "y"}], "]"}], "->", "0"}], "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{"y", "->", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Proper", " ", "quadratic", " ", "Lagrangians"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"expr6quadraticCorrectP", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"msymbolic", "[", "field", "]"}], "2"], 
          RowBox[{"PfieldSymbol", "[", 
           RowBox[{"field", ",", "x"}], "]"}], 
          RowBox[{"Conjugate", "[", 
           RowBox[{"PfieldSymbol", "[", 
            RowBox[{"field", ",", "x"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"field", ",", "listMesonP"}], "}"}]}], "]"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dPfieldSymbol", "[", 
           RowBox[{"field", ",", "x", ",", "\[Mu]"}], "]"}], 
          RowBox[{"Conjugate", "[", 
           RowBox[{"dPfieldSymbol", "[", 
            RowBox[{"field", ",", "x", ",", "\[Mu]"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"field", ",", "listMesonP"}], "}"}]}], "]"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"expr6quadraticCorrectS", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"msymbolic", "[", "field", "]"}], "2"], 
          RowBox[{"SfieldSymbol", "[", 
           RowBox[{"field", ",", "x"}], "]"}], 
          RowBox[{"Conjugate", "[", 
           RowBox[{"SfieldSymbol", "[", 
            RowBox[{"field", ",", "x"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"field", ",", "listMesonS"}], "}"}]}], "]"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dSfieldSymbol", "[", 
           RowBox[{"field", ",", "x", ",", "\[Mu]"}], "]"}], 
          RowBox[{"Conjugate", "[", 
           RowBox[{"dSfieldSymbol", "[", 
            RowBox[{"field", ",", "x", ",", "\[Mu]"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"field", ",", "listMesonS"}], "}"}]}], "]"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Total", " ", "Lagrangian"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"TotalLagrangian", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "expr6", "+", "expr6quadraticCorrectP", "+", 
        "expr6quadraticCorrectS"}], ")"}], "//", "Expand"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Adding", " ", "the", " ", "ALP"}], "-", 
       RowBox[{
       "\[Gamma]\[Gamma]", " ", "term", " ", "from", " ", "the", " ", 
        "chiral", " ", "rotation"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"La\[Gamma]\[Gamma]ChiralRotation", "=", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["\[Alpha]EM", 
          RowBox[{"2", "Pi"}]]}], "*", 
        RowBox[{"dA", "[", 
         RowBox[{"x", ",", "\[Alpha]", ",", "\[Beta]"}], "]"}], "*", 
        RowBox[{"dA", "[", 
         RowBox[{"x", ",", "\[Mu]", ",", "\[Nu]"}], "]"}], "*", 
        RowBox[{"EPSILON", "[", 
         RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Alpha]", ",", "\[Beta]"}], 
         "]"}], "*", 
        RowBox[{"alp", "[", "x", "]"}], 
        FractionBox["\[Epsilon]", "f\[Pi]"], "*", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"cG", "*", 
          RowBox[{"Simplify", "[", 
           RowBox[{"(", 
            RowBox[{"2", "*", "Nc", "*", 
             RowBox[{"Tr", "[", 
              RowBox[{"\[Kappa]matrix", ".", "Qmatrix", ".", "Qmatrix"}], 
              "]"}]}], ")"}], "]"}]}], "]"}]}]}], ";"}], 
     "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TotalLagrangianALPonly", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TotalLagrangian", "-", 
          RowBox[{"(", 
           RowBox[{"TotalLagrangian", "/.", 
            RowBox[{"{", 
             RowBox[{"\[Epsilon]", "->", "0"}], "}"}]}], ")"}]}], ")"}], "//",
         "Expand"}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Scaling", " ", "various", " ", "fields", " ", "and", " ", "their", " ", 
      "derivatives", " ", "such", " ", "that", " ", "it", " ", "will", " ", 
      "be", " ", "possible", " ", "to", " ", "quickly", " ", "extract", " ", 
      "various", " ", "operators"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"TotalLagrangianScaled", "=", 
     RowBox[{
      RowBox[{"Expand", "[", "TotalLagrangian", 
       RowBox[{"(*", 
        RowBox[{"+", "La\[Gamma]\[Gamma]ChiralRotation"}], "*)"}], "]"}], "/.",
       " ", "repsIndividual"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{"fLagr", ",", "TotalLagrangianScaled", ",", "\"\<MX\>\""}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"tabCrossCheck", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"tabCrossCheck", "/.", 
        RowBox[{"{", 
         RowBox[{"md", "->", 
          RowBox[{"mdsol", "[", "\"\<\[Eta]\>\"", "]"}]}], "}"}]}], "//", 
       "ruleLeadingOrderIsospin"}], "//", "Simplify"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Print", "[", "\"\<Quadratic Lagrangian after the diagonalization:\>\"", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tabCrossCheck", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], " ", 
          SuperscriptBox["m\[Eta]", "2"]}], "+", 
         SuperscriptBox["m\[Eta]pr", "2"], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["m\[Pi]0", "2"]}]}], "->", 
        RowBox[{"-", 
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{"4", 
            RowBox[{"m2ChPTminimal", "[", "\"\<\[Eta]\>\"", "]"}]}], "-", 
           RowBox[{"m2ChPTminimal", "[", "\"\<\[Eta]'\>\"", "]"}], "-", 
           RowBox[{"3", 
            RowBox[{
            "m2ChPTminimal", "[", 
             "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", "]"}]}]}], 
          "]"}]}]}], "}"}]}], "//", "Simplify"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.9446416249078064`*^9, 3.944641641854395*^9}, {
   3.9446417357015133`*^9, 3.944641741087984*^9}, 3.9446419149782104`*^9, {
   3.9446419595380535`*^9, 3.9446419725728664`*^9}, {3.9446421157435246`*^9, 
   3.944642146523798*^9}, {3.944642356565916*^9, 3.9446423875430527`*^9}, {
   3.944642778865778*^9, 3.9446428065817337`*^9}, {3.9446428932511406`*^9, 
   3.9446429663270226`*^9}, {3.94464308446348*^9, 3.944643142691208*^9}, {
   3.944643293289692*^9, 3.944643324699478*^9}, {3.9447242089017906`*^9, 
   3.9447242110525475`*^9}, {3.9447243233950443`*^9, 
   3.9447243242255726`*^9}, {3.9447243743766174`*^9, 
   3.9447243745603447`*^9}, {3.9447246456576424`*^9, 3.944724653700947*^9}, {
   3.9447247090562897`*^9, 3.9447247219490185`*^9}, {3.9448124295919876`*^9, 
   3.9448125148547554`*^9}, {3.9448128177320232`*^9, 3.944812822205242*^9}, {
   3.944892675681986*^9, 3.9448926759415913`*^9}, {3.9451463997426414`*^9, 
   3.9451463999400043`*^9}, {3.9451464872406673`*^9, 3.945146498200115*^9}, {
   3.945187915499674*^9, 3.9451879343121414`*^9}, {3.945188555538656*^9, 
   3.945188561100212*^9}, {3.945189854525898*^9, 3.945189869892044*^9}, {
   3.9451900390417156`*^9, 3.9451900413476906`*^9}, {3.9470073017003593`*^9, 
   3.947007311322441*^9}, {3.9484344832487774`*^9, 
   3.948434544617674*^9}},ExpressionUUID->"ae178c43-e10a-cb45-8934-\
642f96c029de"],

Cell[BoxData[
 FormBox["\<\"Quadratic Lagrangian after the diagonalization:\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{3.9448125394594917`*^9, 3.944812848794012*^9, 
  3.9448927029480953`*^9, 3.944892780861017*^9, 3.9448940149442024`*^9, 
  3.9449237935820694`*^9, 3.9449355011369076`*^9, 3.9451464379433155`*^9, 
  3.9451465363659267`*^9, 3.9451884097124004`*^9, 3.945188600241482*^9, 
  3.945189898821478*^9, 3.9451899617755356`*^9, 3.9451901032184105`*^9, 
  3.9452274992390785`*^9, 3.947007371682991*^9, 3.9470075049486713`*^9, 
  3.947054582793377*^9},
 CellLabel->
  "During evaluation of \
In[82]:=",ExpressionUUID->"d4c2bf08-da7a-bb43-a918-d0c8fef91ea6"],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"P1\"\>", "\<\"P2\"\>", "\<\"\\!\\(\\*SubscriptBox[\\(L\\), \
\\(P1P2, mass\\)]\\)\"\>", "\<\"\\!\\(\\*SubscriptBox[\\(L\\), \\(P1P2, \
kinetic\\)]\\)\"\>"},
     {"\<\"a\"\>", "\<\"a\"\>", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["ma", "2"], "2"]}], 
      FractionBox["1", "2"]},
     {"\<\"a\"\>", "\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(0\\)]\\)\"\>",
       "0", "0"},
     {"\<\"a\"\>", "\<\"\[Eta]\"\>", "0", "0"},
     {"\<\"a\"\>", "\<\"\[Eta]'\"\>", "0", "0"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(0\\)]\\)\"\>", "\<\"a\"\>",
       "0", "0"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(0\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(\[Pi]\\), \\(0\\)]\\)\"\>", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["m\[Pi]0", "2"], "2"]}], 
      FractionBox["1", "2"]},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(0\\)]\\)\"\>", "\<\"\[Eta]\
\"\>", "0", "0"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(0\\)]\\)\"\>", \
"\<\"\[Eta]'\"\>", "0", "0"},
     {"\<\"\[Eta]\"\>", "\<\"a\"\>", "0", "0"},
     {"\<\"\[Eta]\"\>", "\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(0\\)]\\)\
\"\>", "0", "0"},
     {"\<\"\[Eta]\"\>", "\<\"\[Eta]\"\>", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["m\[Eta]", "2"], "2"]}], 
      FractionBox["1", "2"]},
     {"\<\"\[Eta]\"\>", "\<\"\[Eta]'\"\>", "0", "0"},
     {"\<\"\[Eta]'\"\>", "\<\"a\"\>", "0", "0"},
     {"\<\"\[Eta]'\"\>", "\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \
\\(0\\)]\\)\"\>", "0", "0"},
     {"\<\"\[Eta]'\"\>", "\<\"\[Eta]\"\>", "0", "0"},
     {"\<\"\[Eta]'\"\>", "\<\"\[Eta]'\"\>", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["m\[Eta]pr", "2"], "2"]}], 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9446433059324036`*^9, 3.944724363196087*^9, 
  3.9447244008894196`*^9, 3.944724694427761*^9, 3.9448125394650917`*^9, 
  3.9448128487975235`*^9, 3.9448927029623528`*^9, 3.94489278086178*^9, 
  3.9448940149612904`*^9, 3.944923793646124*^9, 3.944935501242363*^9, 
  3.9451464379600086`*^9, 3.9451465363694344`*^9, 3.945188409723917*^9, 
  3.9451886002444954`*^9, 3.9451898988286934`*^9, 3.9451899617795353`*^9, 
  3.94519010322241*^9, 3.945227499246584*^9, 3.9470073716899834`*^9, 
  3.9470075049486713`*^9, 3.94705458279838*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"39ff3e33-a354-2d4f-99b8-770cf3b2e6c3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exporting to FeynRules output", "Subsection",
 CellChangeTimes->{{3.9010885752175555`*^9, 
  3.901088580315792*^9}},ExpressionUUID->"f39e1af4-2e90-46f6-bf9e-\
1214cec5e552"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ruleToFeynRules1", "=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"field", "=", "field"}], ",", 
           RowBox[{"fieldSymb", "=", 
            RowBox[{"fieldSymbol", "[", "field", "]"}]}], ",", 
           RowBox[{"fieldDSymb", "=", 
            RowBox[{"dfieldSymbol", "[", "field", "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"fieldDSymb", "[", 
            RowBox[{"x", ",", "c_"}], "]"}], ":>", 
           RowBox[{"ddd", "[", 
            RowBox[{"fieldSymb", ",", "c"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"field", ",", 
         RowBox[{"Join", "[", 
          RowBox[{"listMesonP", ",", "listMesonS"}], "]"}]}], "}"}]}], "]"}], 
     "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"ruleToFeynRules2", "=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"field", "=", "field"}], ",", 
           RowBox[{"fieldSymb", "=", 
            RowBox[{"fieldSymbol", "[", "field", "]"}]}], ",", 
           RowBox[{"fieldDSymb", "=", 
            RowBox[{"dfieldSymbol", "[", "field", "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"fieldSymb", "[", "x", "]"}], ":>", "fieldSymb"}], "}"}]}],
         "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"field", ",", 
         RowBox[{"Join", "[", 
          RowBox[{"listMesonP", ",", "listMesonS"}], "]"}]}], "}"}]}], "]"}], 
     "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"imp1", "=", 
    RowBox[{"TotalLagrangian", "/.", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"ruleOnlyFields", "[", 
       RowBox[{"Join", "[", 
        RowBox[{"listMesonP", ",", "listMesonS"}], "]"}], "]"}], "]"}]}]}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{"imp2", "=", 
    RowBox[{"imp1", "/.", "ruleToFeynRules1"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"imp3", "=", 
    RowBox[{"imp2", "/.", "ruleToFeynRules2"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"imp4", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"imp3", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ma", "->", "mALP"}], ",", 
         RowBox[{"\[Alpha]", "->", "\[Alpha]1"}], ",", 
         RowBox[{"\[Beta]", "->", "\[Alpha]2"}], ",", 
         RowBox[{"\[Mu]", "->", "\[Alpha]3"}], ",", 
         RowBox[{"\[Nu]", "->", "\[Alpha]4"}], ",", 
         RowBox[{
          RowBox[{"EPSILON", "[", 
           RowBox[{
           "\[Mu]_", ",", "\[Nu]_", ",", "\[Alpha]_", ",", "\[Beta]_"}], 
           "]"}], ":>", "ee"}]}], "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Epsilon]", "->", "\[Epsilon]"}], ",", 
        RowBox[{"ee", "->", 
         RowBox[{"eps", "[", 
          RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Alpha]", ",", "\[Beta]"}], 
          "]"}]}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0", "[", 
        RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":>", 
       RowBox[{"eps", "[", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], "}"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Lagrangian.m\>\""}], "}"}], "]"}], ",", "imp4", ",", 
     "\"\<MX\>\""}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.9010877779037375`*^9, 3.9010877839923954`*^9}, {
   3.9010878250761833`*^9, 3.90108784173*^9}, {3.9010883534844613`*^9, 
   3.9010883844712815`*^9}, {3.9010884467330637`*^9, 3.90108844783407*^9}, {
   3.9010885197163305`*^9, 3.9010885306584735`*^9}, {3.9010889926175156`*^9, 
   3.9010890157823725`*^9}, {3.901089051378801*^9, 3.901089052054634*^9}, {
   3.9010893445801153`*^9, 3.901089392888624*^9}, {3.9010901249648356`*^9, 
   3.9010902981323895`*^9}, {3.9010905336089215`*^9, 3.901090561211686*^9}, {
   3.90109061105081*^9, 3.901090611194641*^9}, {3.9010913200280027`*^9, 
   3.901091348918395*^9}, {3.9010913816321807`*^9, 3.901091422593212*^9}, {
   3.901091453941079*^9, 3.901091526276376*^9}, {3.9010917459620466`*^9, 
   3.901091795075549*^9}, {3.9010921027308273`*^9, 3.901092105966467*^9}, {
   3.9010926152514353`*^9, 3.901092722831091*^9}, {3.9010928323040624`*^9, 
   3.901092902168002*^9}, {3.9010929501256466`*^9, 3.901092953524041*^9}, {
   3.901093578971405*^9, 3.9010935791976547`*^9}, {3.9010937649055724`*^9, 
   3.901093811102662*^9}, {3.9010945958465586`*^9, 3.901094601759694*^9}, 
   3.901094768355647*^9, {3.901094966901808*^9, 3.9010949711167717`*^9}, 
   3.9010973572343235`*^9, {3.901097555862142*^9, 3.901097559831809*^9}, {
   3.901099003894343*^9, 3.901099007767215*^9}, {3.90109905189839*^9, 
   3.901099161391658*^9}, {3.9010992053025293`*^9, 3.901099223263669*^9}, {
   3.9010992628331766`*^9, 3.9010992628427143`*^9}, {3.9010992947926655`*^9, 
   3.9010993260438757`*^9}, {3.9010993927360253`*^9, 
   3.9010993927516465`*^9}, {3.9010995009165335`*^9, 3.901099508867407*^9}, 
   3.9010995473211145`*^9, {3.901099640069991*^9, 3.901099653839466*^9}, {
   3.9010997223526697`*^9, 3.9010997252743006`*^9}, {3.901100043396517*^9, 
   3.901100068384134*^9}, 3.901100122963353*^9, {3.9011003540938396`*^9, 
   3.901100415815919*^9}, {3.901100639018858*^9, 3.90110063914427*^9}, {
   3.9011009673305902`*^9, 3.901100975935835*^9}, {3.90110129615314*^9, 
   3.9011012967336383`*^9}, {3.901101665810054*^9, 3.901101678128704*^9}, {
   3.9011020666304045`*^9, 3.9011020691403074`*^9}, 3.901102240946889*^9, {
   3.901116609055589*^9, 3.901116609055589*^9}, 3.905483596572519*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"45385e11-f4c8-4e63-8a42-450bf870e5a4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final definitions", "Section",
 CellChangeTimes->{{3.944643191878132*^9, 
  3.944643194148695*^9}},ExpressionUUID->"fbb7ce7d-ceb8-7b4c-a4ed-\
9055fc99a420"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"LagrangianGivenFields", "[", 
   RowBox[{"fieldlist_", ",", "powerlist_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"terms", "=", 
     RowBox[{"Total", "[", 
      RowBox[{"Cases", "[", 
       RowBox[{"TotalLagrangianScaled", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"t", "^", 
           RowBox[{"(", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"fieldlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "*", 
               RowBox[{"powerlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "fieldlist", "]"}]}], "}"}]}], "]"}], 
            ")"}]}], "*", "aa_"}], ":>", "aa"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Number of terms in the Lagrangian (may be reduced by a factor of few \
since the symmetry over indices permutations is not included at this step):\>\
\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"TotalLagrangianScaled", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Example: the Lagrangian including exactly 1 ALP, 1 \
\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\), 1 \!\(\*SuperscriptBox[\(\[Pi]\), \
\(-\)]\), and 1 \!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\):\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"LagrangianGivenFields", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<a\>\"", ",", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", 
       ",", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.945187896264942*^9, 3.945187896286413*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"db050559-66da-384c-bda3-34285a427ac5"],

Cell[BoxData[
 FormBox["\<\"Number of terms in the Lagrangian (may be reduced by a factor \
of few since the symmetry over indices permutations is not included at this \
step):\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{3.9446433364589596`*^9, 3.9448927158701763`*^9, 
  3.944892780901636*^9, 3.944894019390938*^9, 3.944923793677742*^9, 
  3.9449355013499546`*^9, 3.9451464438398*^9, 3.9451465364033184`*^9, 
  3.9451886002695255`*^9, 3.9451901032642307`*^9, 3.945227499311178*^9, 
  3.9470075050188084`*^9, 3.947044189802223*^9, 3.94705458282938*^9},
 CellLabel->
  "During evaluation of \
In[83]:=",ExpressionUUID->"f8c931d7-81cd-f942-ba2c-596516a0a697"],

Cell[BoxData[
 FormBox["53888", TraditionalForm]], "Output",
 CellChangeTimes->{3.944643336462961*^9, 3.9448927158733654`*^9, 
  3.9448927809100075`*^9, 3.9448940193954716`*^9, 3.944923793677742*^9, 
  3.9449355013539543`*^9, 3.9451464438437977`*^9, 3.9451465364078293`*^9, 
  3.9451886002730427`*^9, 3.9451901032667465`*^9, 3.9452274993196697`*^9, 
  3.9470075050188084`*^9, 3.947044189804228*^9, 3.947054582834379*^9},
 CellLabel->"Out[85]=",ExpressionUUID->"34c7c2c1-0fcb-674d-a5d1-c8680ddabb17"],

Cell[BoxData[
 FormBox["\<\"Example: the Lagrangian including exactly 1 ALP, 1 \
\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(+\\)]\\), 1 \
\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(-\\)]\\), and 1 \
\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(0\\)]\\):\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{3.9446433364589596`*^9, 3.9448927158701763`*^9, 
  3.944892780901636*^9, 3.944894019390938*^9, 3.944923793677742*^9, 
  3.9449355013499546`*^9, 3.9451464438398*^9, 3.9451465364033184`*^9, 
  3.9451886002695255`*^9, 3.9451901032642307`*^9, 3.945227499311178*^9, 
  3.9470075050188084`*^9, 3.947044189802223*^9, 3.9470545828353806`*^9},
 CellLabel->
  "During evaluation of \
In[83]:=",ExpressionUUID->"1c1a7ca3-6329-6744-817f-28040b5effa7"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["1", 
    RowBox[{"18", " ", 
     SuperscriptBox["f\[Pi]", "2"]}]], "\[Epsilon]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"alp", "(", "x", ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", 
         RowBox[{"d\[Pi]minus", "(", 
          RowBox[{"x", ",", "\[Mu]"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"\[Pi]0", "(", "x", ")"}], " ", 
            RowBox[{"d\[Pi]plus", "(", 
             RowBox[{"x", ",", "\[Mu]"}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"\[Pi]plus", "(", "x", ")"}], " ", 
            RowBox[{"d\[Pi]0", "(", 
             RowBox[{"x", ",", "\[Mu]"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "cvmd", " ", 
            TemplateBox[{
              RowBox[{
                RowBox[{"m\[Eta]pr", "-", "ma"}]}]},
             "UnitStepSeq"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"cG", " ", 
               RowBox[{"(", 
                RowBox[{"\[Kappa]u", "-", "\[Kappa]d"}], ")"}]}], "+", 
              "\[Pi]0ALP"}], ")"}]}], "-", 
           RowBox[{"2", " ", "\[Pi]0ALP"}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"\[Pi]minus", "(", "x", ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", 
            RowBox[{"d\[Pi]0", "(", 
             RowBox[{"x", ",", "\[Mu]"}], ")"}], " ", 
            RowBox[{"d\[Pi]plus", "(", 
             RowBox[{"x", ",", "\[Mu]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", " ", "cvmd", " ", 
               TemplateBox[{
                 RowBox[{
                   RowBox[{"m\[Eta]pr", "-", "ma"}]}]},
                "UnitStepSeq"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"cG", " ", 
                  RowBox[{"(", 
                   RowBox[{"\[Kappa]u", "-", "\[Kappa]d"}], ")"}]}], "+", 
                 "\[Pi]0ALP"}], ")"}]}], "-", 
              RowBox[{"2", " ", "\[Pi]0ALP"}]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["m\[Pi]0", "2"], " ", 
            RowBox[{"\[Pi]0", "(", "x", ")"}], " ", 
            RowBox[{"\[Pi]plus", "(", "x", ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Delta]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", " ", "cG", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    SqrtBox["6"], " ", "\[Eta]\[Pi]0"}], "+", 
                    RowBox[{
                    SqrtBox["3"], " ", "\[Eta]pr\[Pi]0"}], "+", "1"}], ")"}], 
                  " ", 
                  RowBox[{"(", 
                   RowBox[{"\[Kappa]d", "+", "\[Kappa]u"}], ")"}]}], "+", 
                 RowBox[{"\[Eta]ALP", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"6", " ", "\[Eta]\[Pi]0"}], "+", 
                    RowBox[{"3", " ", 
                    SqrtBox["2"], " ", "\[Eta]pr\[Pi]0"}], "+", 
                    SqrtBox["6"]}], ")"}]}], "+", 
                 RowBox[{"\[Eta]prALP", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"3", " ", 
                    SqrtBox["2"], " ", "\[Eta]\[Pi]0"}], "+", 
                    RowBox[{"3", " ", "\[Eta]pr\[Pi]0"}], "+", 
                    SqrtBox["3"]}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"3", " ", "cG", " ", "\[Kappa]d"}], "-", 
              RowBox[{"3", " ", "cG", " ", "\[Kappa]u"}], "-", 
              RowBox[{"3", " ", "\[Pi]0ALP"}]}], ")"}]}]}], ")"}]}]}], 
       ")"}]}], "-", 
     RowBox[{"3", " ", 
      RowBox[{"dalp", "(", 
       RowBox[{"x", ",", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Pi]plus", "(", "x", ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Pi]0", "(", "x", ")"}], " ", 
            RowBox[{"d\[Pi]minus", "(", 
             RowBox[{"x", ",", "\[Mu]"}], ")"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"\[Pi]minus", "(", "x", ")"}], " ", 
            RowBox[{"d\[Pi]0", "(", 
             RowBox[{"x", ",", "\[Mu]"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Pi]0", "(", "x", ")"}], " ", 
         RowBox[{"\[Pi]minus", "(", "x", ")"}], " ", 
         RowBox[{"d\[Pi]plus", "(", 
          RowBox[{"x", ",", "\[Mu]"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", "cd"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"2", " ", "cG", " ", "\[Kappa]d"}]}], "+", 
           RowBox[{"2", " ", "cG", " ", "\[Kappa]u"}], "+", 
           RowBox[{"2", " ", "cu"}], "+", "\[Pi]0ALP"}], ")"}]}], "+", 
        RowBox[{"3", " ", "cvmd", " ", 
         TemplateBox[{
           RowBox[{
             RowBox[{"m\[Eta]pr", "-", "ma"}]}]},
          "UnitStepSeq"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"cG", " ", 
            RowBox[{"(", 
             RowBox[{"\[Kappa]u", "-", "\[Kappa]d"}], ")"}]}], "+", 
           "\[Pi]0ALP"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.944643336462961*^9, 3.9448927158733654`*^9, 
  3.9448927809100075`*^9, 3.9448940193954716`*^9, 3.944923793677742*^9, 
  3.9449355013539543`*^9, 3.9451464438437977`*^9, 3.9451465364078293`*^9, 
  3.9451886002730427`*^9, 3.9451901032667465`*^9, 3.9452274993196697`*^9, 
  3.9470075050188084`*^9, 3.947044189804228*^9, 3.9470545834614353`*^9},
 CellLabel->"Out[87]=",ExpressionUUID->"bee5f917-c4d2-6a45-a859-49bb5260c990"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.947007332130104*^9, 3.9470073408459225`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"65cd6692-78d0-d643-a0ed-fda496897da6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LagrangianGivenFields", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(f\), \(1\)]\)(1420)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(K\), \(*\(-\)\)]\)\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", "expr11"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox["aVA", 
       SqrtBox["2"]], 
      RowBox[{"PolarizationVector", "[", 
       RowBox[{"pf1", ",", "\[Mu]"}], "]"}], "*", 
      RowBox[{"PolarizationVector", "[", 
       RowBox[{"pK", ",", "\[Mu]"}], "]"}]}], "//", "Contract"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"expr22", "=", 
    RowBox[{
     RowBox[{
      FractionBox["1", "3"], 
      RowBox[{"DoPolarizationSums", "[", 
       RowBox[{
        RowBox[{"DoPolarizationSums", "[", 
         RowBox[{
          RowBox[{"expr11", "*", 
           RowBox[{"ComplexConjugate", "[", "expr11", "]"}]}], ",", "pK"}], 
         "]"}], ",", "pf1"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"pf1", ",", "pf1"}], "]"}], "->", 
        SuperscriptBox["mf1", "2"]}], ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"pK", ",", "pK"}], "]"}], "->", 
        SuperscriptBox["mKstar", "2"]}], ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"pf1", ",", "pK"}], "]"}], "->", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["mf1", "2"], "+", 
           SuperscriptBox["mKstar", "2"], "-", 
           SuperscriptBox["mK", "2"]}], ")"}], "2"]}]}], "}"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"widththeor", "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"8", "Pi"}]], 
     FractionBox["expr22", 
      SuperscriptBox["mf1", "2"]], "*", 
     RowBox[{"Quiet", "[", 
      RowBox[{"(", 
       RowBox[{"p", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             SqrtBox[
              RowBox[{
               SuperscriptBox["p", "2"], "+", 
               SuperscriptBox["mK", "2"]}]], "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["p", "2"], "+", 
               SuperscriptBox["mKstar", "2"]}]]}], "==", "mf1"}], ",", "p"}], 
          "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"widththeor", "/.", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"aVA", "->", "5.43"}], ",", 
        RowBox[{"mKstar", "->", 
         RowBox[{
         "MASS", "[", "\"\<\!\(\*SuperscriptBox[\(K\), \(*\(+\)\)]\)\>\"", 
          "]"}]}], ",", 
        RowBox[{"mf1", "->", 
         RowBox[{
         "MASS", "[", "\"\<\!\(\*SubscriptBox[\(f\), \(1\)]\)(1420)\>\"", 
          "]"}]}], ",", 
        RowBox[{"mK", "->", 
         RowBox[{
         "MASS", "[", "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\"", 
          "]"}]}]}], "}"}], "\[IndentingNewLine]", "widthexpr"}]}], "=", 
    "0.0445"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.94700734429533*^9, 3.9470073531891956`*^9}, 
   3.9470458466557827`*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"ac4a7a54-5df1-d147-8de1-b7721b1305b1"],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{3.9470073869749165`*^9, 3.9470441838791714`*^9},
 CellLabel->
  "Out[442]=",ExpressionUUID->"fc20d0ba-dcca-474b-b891-2207c9bbe8ca"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1011.75},
WindowMargins->{{-6, Automatic}, {Automatic, -6}},
Magnification:>0.8 Inherited,
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a932d1a5-bce8-5d47-ae75-05febc48e28d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 223, 3, 54, "Chapter",ExpressionUUID->"ff54bf5a-3a9c-4a78-8504-076d2e42f341"],
Cell[802, 27, 1732, 41, 174, "Input",ExpressionUUID->"1656fec3-df5a-ae42-ba30-05fea24b0c8e"],
Cell[CellGroupData[{
Cell[2559, 72, 211, 4, 52, "Section",ExpressionUUID->"182e74c5-ecc8-4a0e-a485-d9a71da3ab97"],
Cell[2773, 78, 18101, 453, 387, "Input",ExpressionUUID->"9fd915b9-6d11-4845-abe3-6a118be2417e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20911, 536, 167, 3, 52, "Section",ExpressionUUID->"6227a437-a31b-4664-ac11-239f261225df"],
Cell[CellGroupData[{
Cell[21103, 543, 165, 3, 42, "Subsection",ExpressionUUID->"0b738306-4a18-6b41-a7bf-641c23077c56"],
Cell[CellGroupData[{
Cell[21293, 550, 17784, 451, 826, "Input",ExpressionUUID->"ae178c43-e10a-cb45-8934-642f96c029de"],
Cell[39080, 1003, 675, 12, 18, "Print",ExpressionUUID->"d4c2bf08-da7a-bb43-a918-d0c8fef91ea6"],
Cell[39758, 1017, 2818, 62, 289, "Output",ExpressionUUID->"39ff3e33-a354-2d4f-99b8-770cf3b2e6c3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42625, 1085, 179, 3, 42, "Subsection",ExpressionUUID->"f39e1af4-2e90-46f6-bf9e-1214cec5e552"],
Cell[42807, 1090, 5926, 128, 113, "Input",ExpressionUUID->"45385e11-f4c8-4e63-8a42-450bf870e5a4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48782, 1224, 162, 3, 52, "Section",ExpressionUUID->"fbb7ce7d-ceb8-7b4c-a4ed-9055fc99a420"],
Cell[CellGroupData[{
Cell[48969, 1231, 2215, 51, 133, "Input",ExpressionUUID->"db050559-66da-384c-bda3-34285a427ac5"],
Cell[51187, 1284, 666, 11, 18, "Print",ExpressionUUID->"f8c931d7-81cd-f942-ba2c-596516a0a697"],
Cell[51856, 1297, 499, 7, 25, "Output",ExpressionUUID->"34c7c2c1-0fcb-674d-a5d1-c8680ddabb17"],
Cell[52358, 1306, 738, 13, 18, "Print",ExpressionUUID->"1c1a7ca3-6329-6744-817f-28040b5effa7"],
Cell[53099, 1321, 5881, 148, 57, "Output",ExpressionUUID->"bee5f917-c4d2-6a45-a859-49bb5260c990"]
}, Open  ]],
Cell[58995, 1472, 173, 2, 22, "Input",ExpressionUUID->"65cd6692-78d0-d643-a0ed-fda496897da6"],
Cell[CellGroupData[{
Cell[59193, 1478, 3513, 101, 139, "Input",ExpressionUUID->"ac4a7a54-5df1-d147-8de1-b7721b1305b1"],
Cell[62709, 1581, 207, 4, 25, "Output",ExpressionUUID->"fc20d0ba-dcca-474b-b891-2207c9bbe8ca"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

